
## 实现多个标签页之间通信

>[!info]+ 本质
> 
> 通过中介者模式，因为标签页之间无法直接通信，需要中介者来进行消息的转发

1. 使用 websocket，websocket 协议可以实现服务器推送，利用服务器来做中介者，标签页向服务器发送数据，再由服务器向其他标签页推送转发
2. 使用 shareWorker，shareWorker 会在页面存在的生命周期内创建一个唯一的线程，并且开启多个页面只会使用同一个线程。这个共享线程就可充当中介者，标签页通过共享线程来实现数据交换
3. 使用 localStorage，我们可以在某一个标签对 localStorage 的变化事件进行监听，当另一标签页修改数据的时候，通过监听事件获取数据。
4. 使用 postMessage，如果能获得对应标签的引用，就能使用 postMessage 方法，进行通信

## 前端存储

cookies：HTML5 标准前本地存储的主要方式
>	优点：
>	1. 兼容性好
>	2. 请求头自带 cookie 方便
> 
>	缺点：
>	1. 大小只有 4k
>	2. 自动请求头加入 cookie 浪费流量
>	3. 每个 domain 限制 20 个 cookie，使用起来麻烦，需要自行封装

localStorage：HTML5 加入的以键值对（key - value）为标准的方式
>	优点：
>	1. 操作方便，永久性存储（浏览器关闭，自动删除）
>	2. 大小为 5 M，兼容 IE 8+

sessionStorage：与 localStorage 基本类似，区别是 sessionStorage 当前页面关闭后会被清理，且与 cookie、localStorage 不同，不能在所有同源窗口中共享，是会话级别的存储方式

Web SQL：2010 年被 W3C 废弃的本地数据库数据存储方案，但是主流浏览器（除火狐）都已经有了相关的实现，web sql 类似于 SQLite，是真正意义上的关系型数据库，用 sql 进行操作，用 JavaScript 时要进行转换，较为繁琐

IndexedDB：正式纳入 HTML5 标准的数据库存储方案，它是 NoSQL 数据库，用键值对（key - value）进行存储，可以进行快速读取操作，非常适合 web 场景，同时用 JavaScript 进行操作非常方便

## 前端安全问题

跨站脚本（Cross-Site Scripting，XSS）：一种代码注入方式，为了与 CSS 区分所以被称作 XSS。早期常见于网络论坛，起因是网站没有对用户输入进行严格限制，使得攻击者可以将脚本上传到帖子让他人浏览到有恶意脚本的页面，其注入方式很简单包括但不限于 JavaScript / CSS / Flash 等

iframe 的滥用：iframe 中的内容是由第三方来提供，默认情况下他们不受控制，他们可以在 iframe 中运行 JavaScript 脚本、Flash 插件、弹出对话框等等，这可能会破坏前端用户体验

跨站点请求伪造（Cross-Site Request Forgery，CSRF）：指攻击者通过设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息或设定信息等某些状态更新，属于被动攻击

恶意第三方库：无论是后端服务器应用还是前端应用开发，绝大多数时候都是在借助开发框架和各种类库进行快速开发，一旦第三方库被植入恶意代码很容易引起安全问题

